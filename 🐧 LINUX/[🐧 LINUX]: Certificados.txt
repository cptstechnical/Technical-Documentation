#=========================================================================================================================
[🐧INSTALAR CERTIFICADO]:
# certificado con dominio local
⚠️ Para un dominio local como el mio necesito un certificado autofirmado

# agrego una carpeta externa al proyecto para no crear un agujero de seguridad y que no puedan vulnerar mi certificado
# creo la carpeta
mkdir /etc/letsencrypt/
cd /var/www/php/letsencrypt

## si quiero generar las claves sin contraseñas simplemente quito de los comandos (-aes256)

## .key :: (clave privada)
# Genero una clave privada
	cd /etc/letsencrypt/
	mkdir 
	openssl genpkey -algorithm RSA -out pruebas.local.key -aes256
	> **********

## .csr :: (Solicitud de firma de certificado)
# Genero un archivo de solicitud de firma de certificado (CSR)
# En un entorno real, una vez generado mi CSR desde mi servidor lo tengo que enviar a la empresa de venta de dominio (como Namecheap) o Autoridad Certificadora (CA) y ellos me lo validan y me devuelven un .crt
	cd /etc/letsencrypt/
	openssl req -new -key pruebas.local.key -out pruebas.local.csr
	> **********

## .crt o .pfx o .pem :: (clave pública)
# Genero el certificado autofirmado con caducidad de 1 año (solo lo genero en el caso que sean pruebas, los "certificados autofirmados" se hacen cuando el dominio no es real)
# En un entorno real, debería enviar la CSR a una Autoridad de Certificación (CA) y utilizar el certificado que me proporcionarían.
	cd /etc/letsencrypt/
	openssl x509 -req -days 365 -in pruebas.local.csr -signkey pruebas.local.key -out pruebas.local.crt
	> **********

# En el caso de caducarse, en un entorno real, tengo que generar otro CSR y repitiendo el proceso con la Autoridad Certificadora (CA).

# modifico el archivo para https de apache
vim  /etc/apache2/sites-available/default-ssl.conf
--------------------------------------------------------------------------------------
...
DocumentRoot /var/www/php

SSLEngine on
SSLCertificateFile /var/www/php/letsencrypt/pruebas.local.crt
SSLCertificateKeyFile /var/www/php/letsencrypt/pruebas.local.key
...
--------------------------------------------------------------------------------------

# habilito ssl
sudo a2enmod ssl

# habilito un nuevo Virtual Host
sudo a2ensite default-ssl.conf

# reinicio los servicios
sudo systemctl reload apache2
sudo systemctl restart apache2
#	> **********
