========================================================================================================
[üë∫ ¬øcomo funciona?]::

# 1 - crea un nuevo dispositivo (limpio)
# 2 - crea graficos
# 3 - para crear graficos los hace a trav√©s de plantillas hay dos opciones:
#	a ~ elegir una plantilla para el grafico: este caso se suele utilizar para crear un gr√°fico de un OID en concreto
#	    üö® [Devices > New Graph Template > SNMP - Generic OID Template > One Deciamls o Two Decimals > min:0 max:u OID:X.X.X.X]
#	b ~ elegir una plantilla para el dispositivo: este caso se suele utilizar para monitorizar discos, particiones... etc. (crear y busca autom√°ticamente los espacios... etc para luego asignar de qu√© quiero un grafico)
#	    üö® [Devices > Associated Data Queries > Net-SNMP - Get Monitored Partitions > add]


# Esquema resumido de la l√≥gica de Cacti: 

+-------------------+           +------------------+			# Definici√≥n de funcionalidad
|                   |           |                  |			# --------------------------------------------------------------------------------------------------------------
|   Data Source     +---------->+ Associated       |			# Data Source: Es la entidad principal que define qu√© datos se monitorean.	
|                   |           | Data Queries     |			# Associated Data Queries: Especifica c√≥mo se obtienen los datos para una Data Source.
+-------------------+           +------------------+			# Graph Template: Define c√≥mo se visualizan los datos en un gr√°fico.
          |                               ^						# Associated Graph Templates: Asocia una plantilla de gr√°fico espec√≠fica a una Data Source para la visualizaci√≥n de los datos.		
          |                               |
          v                               |
+-------------------+           +------------------+			# Interface web
|                   |           |                  |			# --------------------------------------------------------------------------------------------------------------
|   Graph Template  +---------->+ Associated       |			# Management - Desde aqu√≠ agrego todo lo necesario (dispositivos, arboles, sitios...).
|                   |           | Graph Templates  |			# Templates - Desde aqu√≠ configuro las necesidades generales del template utilizado.
+-------------------+           +------------------+			# Import/Export - Desde aqu√≠ voy a importar y exportar los templates que necesite del servidor antiguo al nuevo.
																# Configuration / Settings - Desde aqu√≠ voy a configurar las opciones que permanecen por sesion.
																# Logged is admin / Edit profile - Desde aqu√≠ voy a configurar las opciones del usuario. 


========================================================================================================
[üë∫ Agregar un servidor]::
## para editas los graficos referentes a cada Management:
**************************************************************************
Management > Data Sources > Device: <NOMBRE_DEL_MANAGEMENT> > click > *Edit Graph: <Management>

## üö® a ~ para agregar un Servidor ¬∑ [snmp preestablecidos]:
**************************************************************************
# 1 - creo el dispositivo
# creo un dispositivo guiandome en otro parecido, lo importante es la IP y el SNMP  
Managemente > Device > + 

# 2 - vinculo los SNMP para poder monitorizar las particiones
- Una vez creado lo busco por Managemente > Device
- Entro en el dispositivo
- busco "Associated Data Queries" y creo los siguientes:
	+ SNMP - Get Mounted Partitions												# particiones montadas en un dispositivo
	+ SNMP - Get Processor Information											# CPU, procesador, frecuencia, n√∫cleos...
	+ SNMP - Interface Statistics												# estad√≠sticas de interfaces
	+ Net-SNMP - Sensors - Thermal Sensors

	- siempre que el servidor sea un Linux tengo que agregar en: Associated Graph Templates - Graaph Template Name 
		+ Linux CPU Usage - Patricio 											# con agregarlo no hay que hacer m√°s...
- save 

# 3 - selecciono las particiones que quiero monitorizar
Create Graphs for this Device
- Pulso en SNMP - Interface Statistics 
- selecciono las unidades que importan desde "Data Query [SNMP - Get Mounted Partitions]" en este caso: 
	+ /
	+ /var
	+ /boot
	+ Physical memory
	+ Virtual memory
	# si me equivocado al seleccionar alguno que no qer√≠a haber seleccionado:
	Management > Graphs > -selecciono- > delete > Go

Data Query [Net-SNMP - Get Device I/O]
- Selecciono los dispositivos principales
	+ sda
Data Query [SNMP - Interface Statistics]
- Selecciono las interfaces m√°s importantes
	+ eth0

- save
# color por defecto : Cacti Color (00BD27)

# 4 - agrego en los gr√°ficos
- Management > Trees 
- selecciono el padre que quiero agregar el servidor en mi caso "servidores"
- (desplazo los graficos creados)
- save

# 5 - ejeplo de monitorizaci√≥n (random server):
# este apartado sirve solo de ejemplo no hay que realizarlo
	Thermal Sensor Device : ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ	Package id 0
			‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ temp1
			‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ temp2
	Data Query [SNMP - Get Mounted Partitions] : ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Physical memory
			‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Virtual memory
			‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ	/
	Data Query [SNMP - Get Processor Information] : ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Total
	Data Query [SNMP - Interface Statistics] : ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ	eno1


## üö® b ~ para agregar un dispositivo (ej: esp32) ¬∑ [snmp √∫nico - OID directo]:
**************************************************************************
# 1 - creo el dispositivo
# creo un dispositivo guiandome en otro parecido, lo importante es la IP y el SNMP  
Managemente > Device > + 
# en el caso de un iDRAC, lo configuro en modo ping (sin snmp)
# > Availability/Reachability Options
#	Downed Device Detection: Ping
#	Ping Method: ICMP PING
#	Ping Timeout Value: 400
#	Ping Retry Count:1

# 2 - vinculo los SNMP para poder monitorizar las particiones
# tambi√©n puedo lanzar una plantilla para automatizar el proceso, pero si quiero agregar directamente un OID
# > Associated data queries > Data query name > SNMP - Interface Statistics

# creo la gr√°fica
> Create Graphs for this device

# tengo un problema no planteado en esp:
# Mi ESP32 solo expone la MIB RFC1213 m√≠nima (parte de .1.3.6.1.2.1.1.x) y una MIB custom bajo .1.3.6.1.4.1.8266..., pero NO implementa la tabla de interfaces SNMP (.1.3.6.1.2.1.2.2), que es la que Cacti usa por defecto para detectar dispositivos con el SNMP Query interface.xml

# agrego el gr√°fico de manera manual:
> New Graph Template > SNMP - Generic OID Template > Create
# con mis scritps
> New Graph Template > SNMP - Generic OID Template > Deciamls (ej: 500 o 500,0)
> New Graph Template > SNMP - Generic OID Template > One Deciamls (ej: 500 o 500,0)	# este nunca lo utilizo porque no est√° bien desarrollado, para eso utilizo el de arriba.
> New Graph Template > SNMP - Generic OID Template > Two Deciamls (ej:500,07 o 500,90)

# ‚ö† relleno con los datos y muy importante rellenand el OID que quiero registrar
‚ö†Ô∏è Minimum Value ("U" for No Minimum): 0										# valor inicial 0
‚ö†Ô∏è Maximum Value ("U" for No Maximum): u										# valor inicial u, no le doy un m√°ximo si no que lo registra de manera autom√°tica as√≠ no hay fallo...
OID: .1.3.6.1.4.1.6...
Data Source Type: GAUGE
Vertical Label: Celsius
Legend text: Temperature
Auto scale options: Use --alt-autoscale (ignoring given limits)

# ‚ö† Si al guardar el grafico ya terminado ocurre que en la barra vertical no corresponde a la realidad, he seleccionado mal el template 
#		+ cuando ocurre esto hay dos opciones 
#		+ opci√≥n 1 : en el caso de que tenga un historial de datos (lleve tiempo recibiendo datos), tengo que seguir los siguiente pasos :
#			- creo un data-sources nuevo con los nuevos valores (Templates > Data-sources > +).
#			- (Management - Data-sources) busco el data-sources y le asocio en "Data Template Selection" - "Selected Data Template" el que he creado anteriormente.
#			- aora queda sobrante un data-source (Template > Data source), selecciono checkbox y "delete".
#		+ opci√≥n 2 : si lo acabo de crear lo borro y vuelvo a crear uno nuevo.

# para comprobar el OID voy al servidor de cacti y : 
snmpwalk -v2c -c <COMMUNITY-SNMP> -Oneq <IP-SNMP> .1							# saca todos los snmp, [todos los que empiezan con 1.]. (cuidado con la memoria del servidor)
snmpwalk -v2c -c <COMMUNITY-SNMP> -Oneq <IP-SNMP> .1 > dc1-kvm1.snmpwalk        # Exporta √°rbol SNMP completo al archivo dc1-kvm1.snmpwalk.

snmpwalk -v2c -c <COMMUNITY-SNMP> -On -Oeq <IP-SNMP> <OID>						# saca el snmp del OID pasado por par√°metro
snmpwalk -v2c -c <COMUNITY> <IP> <OID_SNMP>										# saca el snmp del OID pasado por par√°metro

# colores preferidos
	COLORES::
	------------------------------------
	> Cyan:		Cacti Color (00BED9)
	> Azul:		Cacti Color (2175D9)
	> Verde:	Cacti Color (7EE600)
	> Rojo:		Cacti Color (FF5576)

	COLORES Temp iDRAC::
	------------------------------------
	> Rojo:		Chilli Pepper (C11B17)											# CPU Temp
	> Naranja:	Cacti Color (FF9900)											# System Board Inlet Temp
	> Rosa:		Cadillac Pink (E38AAE)											# System Board Exhaust Temp

# ‚ö†Ô∏è si al terminar el gr√°fico los valores que obtengo en el medidor vertical son erroneos y no coinciden con lo que deber√≠a ser... el problema est√° en la elecci√≥n del Two Decimals o One Decimals


========================================================================================================
[üë∫ Como crar un gr√°fico con muchas gr√°ficas juntas]
# para crear un grafico el cu√°l tenga varias graficas dentro de la misma como algunos templates que viene construidos hay que hacer lo sigueinte:
#			- creo varios data-sources nuevo con los nuevos valores (Templates > Data-sources > +)
#			- creo un nuevo graph (Templates > Graph > +), asocio los nuevos "Graph Item Inputs" al data sources que acabo de crear





